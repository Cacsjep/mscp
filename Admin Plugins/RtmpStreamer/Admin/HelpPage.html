<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>RTMP Streamer Plugin</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Segoe UI, Tahoma, Geneva, Verdana, sans-serif;
            font-size: 13px;
            color: #222;
            padding: 0px 28px;
            line-height: 1.55;
        }
        h1 {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 6px;
            color: #1a1a1a;
        }
        .subtitle {
            color: #666;
            margin-bottom: 20px;
        }
        h2 {
            font-size: 14px;
            font-weight: 600;
            margin: -4px 0 8px;
            color: #333;
        }
        h3 {
            font-size: 13px;
            font-weight: 600;
            margin: 12px 0 6px;
            color: #444;
        }
        ul {
            margin: 0 0 0 20px;
            padding: 0;
        }
        li {
            margin-bottom: 4px;
        }
        p {
            margin-bottom: 10px;
        }
        .card {
            background: #fff;
            border: 1px solid #dde0e4;
            border-radius: 6px;
            padding: 16px 20px;
            margin-bottom: 14px;
        }
        .steps {
            counter-reset: step;
            list-style: none;
            margin-left: 0;
        }
        .steps li {
            counter-increment: step;
            padding-left: 28px;
            position: relative;
            margin-bottom: 8px;
        }
        .steps li::before {
            content: counter(step);
            position: absolute;
            left: 0;
            top: 0;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2868b8;
            color: #fff;
            font-size: 11px;
            font-weight: 600;
            text-align: center;
            line-height: 20px;
        }
        .header-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
        }
        .header-row h1 {
            margin-bottom: 0;
        }
        .chips {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-left: auto;
        }
        .chip-amber {
            display: inline-block;
            background: #fdf6ec;
            border: 1px solid #e0b96a;
            border-radius: 12px;
            padding: 3px 10px;
            font-size: 11px;
            font-weight: 500;
            color: #7a5a1a;
            white-space: nowrap;
            margin-right: 3px;
        }
        .chip-blue {
            display: inline-block;
            background: #eef4fb;
            border: 1px solid #a3c4e4;
            border-radius: 12px;
            padding: 3px 10px;
            font-size: 11px;
            font-weight: 500;
            color: #2a5a96;
            white-space: nowrap;
            margin-right: 3px;
        }
        .diagram {
            font-family: Consolas, Courier New, monospace;
            font-size: 11px;
            background: #f0f2f5;
            border: 1px solid #dde0e4;
            border-radius: 4px;
            padding: 12px 16px;
            margin: 8px 0 10px;
            line-height: 1.6;
            white-space: pre;
            overflow-x: auto;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="header-row">
        Stream live camera video from Milestone XProtect to RTMP servers
        <div class="chips">
            <span class="chip-amber" title="This is an independent open-source project provided as-is under the MIT License, with no warranty. Not affiliated with Milestone Systems. Use at your own risk.">Open source &mdash; no warranty, use at own risk</span>
            <span class="chip-amber" title="Only H.264 cameras are supported. Make sure the selected camera is configured for H.264 encoding on the Recording Server.">H.264 only &mdash; no H.265 / MJPEG</span>
            <span class="chip-amber" title="Device audio is not yet supported. A silent audio track is generated automatically to satisfy RTMP server requirements.">No device audio &mdash; silent track used</span>
            <span class="chip-blue" title="After saving a configuration change, it may take a few seconds for the live log to reflect the updated status. Starting and stopping a stream can also take a few seconds to take effect.">Save &amp; status updates delayed a few seconds</span>
        </div>
    </div>

    <div class="card">
        <h2>How It Works</h2>
        <p>
            This plugin takes the live video from your Milestone cameras and
            streams it to an RTMP server of your choice. Each configured stream
            runs independently, so you can publish multiple cameras at the same time.
        </p>
    </div>

    <div class="card">
        <h2>Getting Started</h2>
        <ol class="steps">
            <li>Click on the <strong>RTMP Streams</strong> node in the tree on the left.</li>
            <li>Right-click and select <strong>Create New</strong> to add a stream.</li>
            <li>Choose a camera, enter your RTMP URL and stream key, then click <strong>Save</strong>.</li>
        </ol>
    </div>

    <div class="card">
        <h2>Live Log</h2>
        <p>
            When you select an enabled stream, the detail panel shows a live log at
            the bottom. This log displays the most recent output from the helper
            process in real time.
        </p>
        <p>
            The log shows the last 40 messages from the streaming process and
            refreshes automatically about twice per second.
        </p>
        <p>Log lines are color-coded by level:</p>
        <ul>
            <li><strong style="color:#388e3c;">INFO</strong> &mdash; normal operational messages (green)</li>
            <li><strong style="color:#f9a825;">WARN</strong> &mdash; warnings (yellow)</li>
            <li><strong style="color:#c62828;">ERROR</strong> &mdash; errors (red)</li>
            <li><strong style="color:#9e9e9e;">DEBUG</strong> &mdash; debug details (gray)</li>
        </ul>
    </div>

    <div class="card">
        <h2>Logging &amp; Diagnostics</h2>

        <h3>Live Status (Management Client)</h3>
        <p>
            The detail panel shows the current stream status, frames per second,
            bitrate, and the live log. This data is pushed from the Event Server
            and updates automatically while the stream item is selected.
        </p>

        <h3>Milestone System Log</h3>
        <p>
            Significant events are written to the Milestone System Log (visible
            under <em>Logs &gt; System Log</em> in the Management Client). These
            include stream connected, stream error, stream stopped, helper crashed,
            and plugin started/stopped events.
        </p>

        <h3>Event Server Log Files</h3>
        <p>
            Administrative messages (configuration reloads, helper launches) are
            written to the Event Server log files at:<br />
            <code>C:\ProgramData\Milestone\XProtect Event Server\Logs\</code>
        </p>
    </div>

    <div class="card">
        <h2>Architecture</h2>
        <p>The plugin consists of three components that run in different processes:</p>

        <h3>Management Client (Admin UI)</h3>
        <p>
            Provides the configuration interface you are using now. Lets you create,
            edit, and delete stream items. When a stream is selected, it subscribes to
            live status updates from the Event Server and displays them in the detail
            panel (status, FPS, bitrate, and a live log).
        </p>

        <h3>Event Server (Background Plugin)</h3>
        <p>
            Runs as a background service inside the Milestone Event Server. It reads
            the saved stream configurations, launches one helper process per enabled
            stream, and monitors their health. If a helper crashes it is restarted
            automatically. The Event Server also relays live status and log messages
            from the helpers to the Management Client.
        </p>

        <h3>Helper Process (RtmpStreamerHelper.exe)</h3>
        <p>
            A standalone executable launched by the Event Server for each stream.
            It initializes the Milestone SDK, connects to the Recording Server to
            receive live camera frames, muxes them into FLV, and publishes to the
            RTMP endpoint. Each helper runs in isolation so one failing stream does
            not affect the others.
        </p>

        <div class="diagram">Management Client          Event Server               Helper Process
      (Admin UI)          (Background Plugin)      (RtmpStreamerHelper.exe)
          |                       |                          |
          |--- Save Config ------>|                          |
          |                       |--- Launch Process ------>|
          |                       |                          |-- Connect to RecServer
          |                       |                          |-- Connect to RTMP
          |                       |<--- stderr: STATUS ------|
          |                       |<--- stderr: STATS  ------|
          |                       |<--- stderr: log lines ---|
          |<-- MessageComm -------|                          |
          |   (live status +      |                          |
          |    log updates)       |                          |</div>
    </div>

    <div class="card" style="font-size:12px; line-height:1.5;">
        <h2>Legal</h2>
        <p>
            This is an independent open-source project and is not affiliated with,
            endorsed by, or supported by Milestone Systems.
            XProtect&reg; is a registered trademark of Milestone Systems A/S.
        </p>
        <p>
            This software is provided &ldquo;as is&rdquo;, without warranty of any kind,
            express or implied, including but not limited to the warranties of
            merchantability, fitness for a particular purpose, and noninfringement.
            In no event shall the authors or copyright holders be liable for any claim,
            damages, or other liability, whether in an action of contract, tort, or
            otherwise, arising from, out of, or in connection with the software or the
            use or other dealings in the software.
        </p>
        <p>
            Use at your own risk. Always test in a non-production environment first.
            This project is licensed under the MIT License.
        </p>
    </div>
</body>
</html>
